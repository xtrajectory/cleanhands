<!DOCTYPE html>

<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cleanhands page</title>
    <style>
        body {
            background-color: black;
            color: white;
            display: flex;
            flex - direction: column;
            align - items: center;
            justify - content: center;
            height: 100vh;
            margin: 0;
            font - family: Arial, sans - serif;
            /* 禁止選取文字 */
            -webkit - user - select: none;
            -moz - user - select: none;
            -ms - user - select: none;
            user - select: none;
        }

        #result {
            font - size: 20px;
            color: red;
            margin - top: 18px;
            padding: 15px;
            border: 2px solid #C6A300;
            border - radius: 10px;
            background - color: rgba(198, 163, 0, 0.1);
            box - shadow: 0 0 10px rgba(0, 0, 0, 0.3);
            text - align: center;
            font - weight: bold;
            max - width: 90%;
            display: inline - block;
        }

        button {
            background - color: orange;
            border: none;
            color: white;
            padding: 15px 30px;
            text - align: center;
            text - decoration: none;
            display: inline - block;
            font - size: 18px;
            margin: 4px 2px;
            cursor: pointer;
            border - radius: 5px;
        }

        table {
            margin - top: 18px;
            border - collapse: collapse;
        }

        th,
        td {
            border: 1px solid white;
            padding: 8px;
            text - align: center;
        }

        th {
            background - color: #333;
        }

        h1 {
            font - size: 20px;
            background - color: #C6A300; /* 將背景顏色改為 #C6A300 */
            color: #fff;
            padding: 10px 20px;
            border - radius: 10px;
            box - shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            text - transform: uppercase;
        }

        #currentDate {
            font - size: 18px;
            color: orange;
        }

        #currentDateTime {
            font - size: 16px;
            color: orange;
            margin - bottom: 22px;
        }

        #disclaimer {
            font - size: 15px;
            margin - top: 10px;
            color: #888;
        }

       .map - button {
            background - color: #977C00;
        }

       .map - button - container {
            position: fixed;
            right: 10px;
            bottom: 40px;
        }

       .map - button {
            background - color: #977C00;
            padding: 10px 20px;
            font - size: 16px;
            border - radius: 5px;
            white - space: nowrap;
        }

       .button - container {
            display: flex;
            justify - content: center;
            gap: 10px;
            margin - top: 20px; /* 稍微調整原始的上邊距 */
            transition: margin - top 0.3s ease; /* 添加過渡效果 */
        }

       .weekday - time {
            color: grey;
            font - size: 20px;
        }

        #lastUpdated {
            position: fixed;
            bottom: 10px;
            right: 10px;
            font - size: 12px;
            color: #888;
        }

       .button - container button {
            background - color: transparent;
            color: grey;
            font - size: 14px;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

       .button - container button:hover {
            background - color: rgba(128, 128, 128, 0.2);
        }

        /* 新增媒體查詢以調整手機上的按鈕佈局 */
        @media (max - width: 768px) {
           .map - button - container {
                position: fixed;
                right: 0;
                bottom: 0; /* 調整到底部 */
                left: 0; /* 擴展到整個寬度 */
                display: flex;
                justify - content: space - around; /* 平均分配空間 */
                background - color: black; /* 可選：添加背景以避免與內容重疊 */
                padding: 10px 0; /* 添加一些內邊距 */
                z - index: 1000; /* 確保在最上層 */
            }

           .map - button {
                padding: 8px 12px; /* 調整按鈕大小 */
                font - size: 14px; /* 調整字體大小 */
                margin: 0 5px; /* 添加按鈕間距 */
            }

            #lastUpdated {
                position: fixed;
                bottom: 0; /* 移到按鈕下方 */
                left: 0;
                right: 0;
                width: 100%;
                text - align: center;
                background - color: rgba(0, 0, 0, 0.8);
                padding: 5px 0; /* 調整內邊距，只保留上下內邊距 */
                border - radius: 0; /* 移除邊角圓弧 */
                z - index: 999;
                display: flex;
                justify - content: center;
            }

           .button - container {
                margin - top: 20px; /* 手機上按鈕容器的原始上邊距 */
            }
        }
    </style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G - EZTW98Q8GK"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());
        gtag('config', 'G - EZTW98Q8GK');
    </script>
</head>

<body oncontextmenu="return false;">
    <h1 id="randomTitle">日期計算</h1>
    <p id="currentDateTime"></p>
    <div id="result"></div>

    <div class="button - container">
        <button onclick="showFutureDates()">未來五天計算結果</button>
        <button onclick="verifyCalculation()">驗算</button> <!-- 將驗算按鈕移動到中間 -->
        <button onclick="export120DaysTable()">導出120天計算結果</button>
    </div>
    <div id="futureDatesTable" style="display: none; margin - bottom: 20px;"></div> <!-- 為表格添加下邊距 -->
    <p id="verificationResult" style="display: none; margin - bottom: 20px;"></p> <!-- 為驗算結果添加下邊距 -->
    <p id="disclaimer">計算結果僅供參考。</p>

    <div class="map - button - container">
        <a href="schedule.html">
            <button class="map - button">📅 Schedule</button>
        </a>
        <a href="age_calculator.html">
            <button class="map - button">🧮 年齡計算</button>
        </a>
        <a href="sums calculate.html">
            <button class="map - button">🔢 總和計算</button>
        </a>
        <a href="https://www.google.com/maps/d/u/0/edit?mid=1smbxbgyDyi21YkzAcOjm2j5B3Ru5KhY&ll=22.196278957288584%2C113.54682999548615&z=16">
            <button class="map - button">🗺️地圖</button>
        </a>
    </div>

    <div id="lastUpdated"></div>

    <script>
        // 禁止右鍵菜單
        document.addEventListener('contextmenu', function (e) {
            e.preventDefault();
            return false;
        });

        // 禁止選取文字
        document.addEventListener('selectstart', function (e) {
            e.preventDefault();
            return false;
        });

        // 禁止複製
        document.addEventListener('copy', function (e) {
            e.preventDefault();
            return false;
        });

        // 禁止剪切
        document.addEventListener('cut', function (e) {
            e.preventDefault();
            return false;
        });

        // 禁止粘貼
        document.addEventListener('paste', function (e) {
            e.preventDefault();
            return false;
        });

        // 禁止鍵盤快捷鍵
        document.addEventListener('keydown', function (e) {
            // 禁止 Ctrl+A (全選)
            if (e.ctrlKey && e.keyCode === 65) {
                e.preventDefault();
                return false;
            }

            // 禁止 Ctrl+C (複製)
            if (e.ctrlKey && e.keyCode === 67) {
                e.preventDefault();
                return false;
            }

            // 禁止 Ctrl+V (粘貼)
            if (e.ctrlKey && e.keyCode === 86) {
                e.preventDefault();
                return false;
            }

            // 禁止 F12 (開發者工具)
            if (e.keyCode === 123) {
                e.preventDefault();
                return false;
            }
        });

        // 定義特別假期
        const specialHolidays = {
            "2025 - 01 - 01": "元旦",
            "2025 - 01 - 28": "農曆除夕",
            "2025 - 01 - 29": "農曆正月初一",
            "2025 - 01 - 30": "農曆正月初二",
            "2025 - 01 - 31": "農曆正月初三",
            "2025 - 04 - 04": "清明節",
            "2025 - 04 - 18": "耶穌受難日",
            "2025 - 04 - 19": "復活節前日",
            "2025 - 04 - 21": "復活節前日的補假",
            "2025 - 05 - 01": "勞動節",
            "2025 - 05 - 05": "佛誕節",
            "2025 - 05 - 31": "端午節",
            "2025 - 06 - 02": "端午節的補假",
            "2025 - 10 - 01": "中華人民共和國國慶日",
            "2025 - 10 - 02": "中華人民共和國國慶日翌日",
            "2025 - 10 - 07": "中秋節翌日",
            "2025 - 10 - 29": "重陽節",
            "2025 - 11 - 02": "追思節",
            "2025 - 11 - 03": "追思節的補假",
            "2025 - 12 - 08": "聖母無原罪瞻禮",
            "2025 - 12 - 20": "澳門特別行政區成立紀念日",
            "2025 - 12 - 21": "冬至",
            "2025 - 12 - 22": "澳門特別行政區成立紀念日的補假",
            "2025 - 12 - 23": "冬至的補假",
            "2025 - 12 - 24": "聖誕節前日",
            "2025 - 12 - 25": "聖誕節",
            "2025 - 12 - 31": "除夕"
        };

        // 定義星期幾的中文名稱
        const weekdays = ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"];

        function calculateFutureDate() {
            try {
                const today = new Date();
                let targetDate = new Date(today.getTime() + 15 * 24 * 60 * 60 * 1000);

                // 添加調試信息
                let debugInfo = `原始15天後日期：${targetDate.getFullYear()}年${targetDate.getMonth() + 1}月${targetDate.getDate()}日\n`;

                while (true) {
                    const dayOfWeek = targetDate.getDay();
                    const dateStr = targetDate.toISOString().split('T')[0];

                    if (dayOfWeek === 0 || dayOfWeek === 6 || dateStr in specialHolidays) {
                        debugInfo += `${dateStr} 為${dayOfWeek === 0? '星期日' : dayOfWeek === 6? '星期六' : specialHolidays[dateStr]}，順延一天\n`;
                        targetDate.setDate(targetDate.getDate() + 1);
                    } else {
                        break;
                    }
                }

                const result = `15天的日期：${targetDate.getFullYear()}年${targetDate.getMonth() + 1}月${targetDate.getDate()}日 ${weekdays[targetDate.getDay()]}`;
                document.getElementById('result').innerHTML = result;

                // 在控制台輸出調試信息
                console.log(debugInfo);
            } catch (error) {
                console.error('計算日期時發生錯誤：', error);
                document.getElementById('result').textContent = '計算錯誤，請稍後重試';
            }
        }

        function showFutureDates() {
            const futureDatesTable = document.getElementById('futureDatesTable');
            const verificationResult = document.getElementById('verificationResult');

            // 如果驗算結果正在顯示，先隱藏它
            if (verificationResult.style.display === 'block') {
                verificationResult.style.display = 'none';
            }

            // 切換未來五天計算結果的顯示狀態
            if (futureDatesTable.style.display === 'block') {
                futureDatesTable.style.display = 'none';
            } else {
                const tableContent = generateFutureDatesTable();
                futureDatesTable.innerHTML = `
                    <table>
                        <thead>
                            <tr>
                                <th>日期</th>
                                <th>第15天</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${tableContent}
                        </tbody>
                    </table>
                `;
                futureDatesTable.style.display = 'block';
            }
        }

        function generateFutureDatesTable() {
            let tableContent = '';
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);

            for (let i = 0; i < 5; i++) {
                const currentDate = new Date(tomorrow.getTime() + i * 24 * 60 * 60 * 1000);
                const fifteenthWorkday = calculateFifteenthWorkday(currentDate);

                tableContent += `
                    <tr>
                        <td>${currentDate.getFullYear()}年${currentDate.getMonth() + 1}月${currentDate.getDate()}日</td>
                        <td>${fifteenthWorkday.getFullYear()}年${fifteenthWorkday.getMonth() + 1}月
