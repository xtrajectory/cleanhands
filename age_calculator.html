<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹´é½¡è¨ˆç®—å™¨</title>
    <style>
        :root {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --input-bg: #2c2c2c;
            --text-main: #ffffff;
            --text-muted: #dddddd;
            --accent-color: #ffa500; /* Orange */
            --accent-hover: #ff8c00;
            --highlight-bg: #C6A300;
            --border-color: #444;
            --danger-bg: rgba(255, 0, 0, 0.2);
            --danger-text: #ff6666;
            --warning-bg: rgba(255, 165, 0, 0.2);
            --warning-text: #ffaa33;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding-top: 5vh; /* ç¨å¾®æ¸›å°‘é ‚éƒ¨ç•™ç™½é©æ‡‰æ‰‹æ©Ÿ */
            min-height: 100vh;
            margin: 0;
            font-family: 'Arial', 'Microsoft JhengHei', sans-serif; /* åŠ å…¥å¾®è»Ÿæ­£é»‘é«” */
            user-select: none;
            -webkit-user-select: none;
        }

        .container {
            text-align: center;
            width: 90%;
            max-width: 600px;
            padding-bottom: 50px;
        }

        h1 {
            font-size: 24px;
            background-color: var(--highlight-bg);
            color: #fff;
            padding: 12px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            margin-bottom: 30px;
            display: inline-block;
        }

        .date-display {
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .today-date {
            color: var(--accent-color);
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .age-date {
            color: var(--text-muted);
            margin: 8px 0;
            font-size: 18px;
        }

        .input-section {
            padding: 25px 20px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            background-color: var(--card-bg);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .input-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            margin: 15px 0;
        }

        .input-wrapper {
            position: relative;
            width: 100%;
            max-width: 250px;
            display: flex;
            align-items: center;
        }

        /* å„ªåŒ–æ—¥æœŸè¼¸å…¥æ¡† */
        input[type="text"] {
            padding: 12px 40px 12px 12px;
            background-color: var(--input-bg);
            color: white;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 18px;
            width: 100%;
            box-sizing: border-box;
            outline: none;
            transition: border-color 0.3s;
            text-align: center;
        }

        input[type="text"]:focus {
            border-color: var(--accent-color);
        }

        input[type="text"]::placeholder {
            color: #888;
        }

        .clear-btn {
            position: absolute;
            right: 6px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: var(--text-muted);
            font-size: 22px;
            font-weight: bold;
            cursor: pointer;
            padding: 0;
            display: block;
            line-height: 1;
            transition: all 0.2s;
            width: 36px;
            height: 36px;
            min-width: 36px;
            min-height: 36px;
            border-radius: 50%;
            z-index: 10;
            -webkit-tap-highlight-color: rgba(255, 165, 0, 0.3);
            touch-action: manipulation;
            user-select: none;
            -webkit-user-select: none;
            box-sizing: border-box;
        }

        .clear-btn:hover {
            color: var(--accent-color);
            background-color: rgba(255, 165, 0, 0.1);
        }

        .clear-btn:active {
            transform: translateY(-50%) scale(0.9);
            color: var(--accent-color);
            background-color: rgba(255, 165, 0, 0.3);
        }

        .clear-btn.hidden {
            display: none !important;
        }

        button {
            background-color: var(--accent-color);
            border: none;
            color: white;
            padding: 12px 30px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 6px;
            transition: background-color 0.2s, transform 0.1s;
            width: 100%;
            max-width: 250px;
        }

        button:hover {
            background-color: var(--accent-hover);
        }

        button:active {
            transform: scale(0.98);
        }

        #ageResult {
            margin-top: 20px;
            font-size: 20px;
            color: var(--accent-color);
            font-weight: bold;
            min-height: 60px; /* é ç•™ç©ºé–“é˜²æ­¢è·³å‹• */
            line-height: 1.6;
        }

        .warning {
            margin-top: 15px;
            padding: 10px;
            border-radius: 6px;
            font-weight: bold;
            display: inline-block;
            width: 100%;
            box-sizing: border-box;
        }

        .warning-red {
            background-color: var(--danger-bg);
            color: var(--danger-text);
            border: 1px solid var(--danger-text);
        }

        .warning-orange {
            background-color: var(--warning-bg);
            color: var(--warning-text);
            border: 1px solid var(--warning-text);
        }

        .disclaimer {
            font-size: 13px;
            color: #666;
            margin-top: 20px;
            font-style: italic;
        }

        /* åœ¨å¤§è¢å¹•ä¸Šè®“è¼¸å…¥æ¡†å’ŒæŒ‰éˆ•ä¸¦æ’ */
        @media (min-width: 500px) {
            .input-group {
                flex-direction: row;
                justify-content: center;
            }
        }
    </style>
</head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EZTW98Q8GK"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EZTW98Q8GK');
</script> 

<body>
    <div class="container">
        <h1>å¹´é½¡è¨ˆç®—å™¨</h1>
        
        <div class="date-display">
            <div class="today-date" id="todayDate">è¼‰å…¥ä¸­...</div>
            <div class="age-date" id="age16Date"></div>
            <div class="age-date" id="age18Date"></div>
        </div>
        
        <div class="input-section">
            <h3>è¨ˆç®—ç‰¹å®šå‡ºç”Ÿæ—¥æœŸçš„å¹´é½¡</h3>
            <div class="input-group">
                <div class="input-wrapper">
                    <input type="text" id="birthDateInput" placeholder="YYYY-MM-DD" inputmode="numeric" pattern="[0-9-]*" aria-label="è¼¸å…¥å‡ºç”Ÿæ—¥æœŸ">
                    <button class="clear-btn hidden" id="clearBtn" onclick="clearInput(event)" aria-label="æ¸…é™¤è¼¸å…¥" type="button">Ã—</button>
                </div>
                <button onclick="calculateAge()">ğŸ” è¨ˆç®—å¹´é½¡</button>
            </div>
            <div id="ageResult"></div>
            <div class="disclaimer">è¨ˆç®—çµæœåƒ…ä¾›åƒè€ƒ</div>
        </div>
    </div>

    <script>
        // --- é˜²æ­¢ä»£ç¢¼è¤‡è£½èˆ‡å³éµä¿è­·å€ ---
        (() => {
            const preventEvents = (e) => {
                e.preventDefault();
                return false;
            };

            // ç¦ç”¨å³éµèœå–®
            document.addEventListener('contextmenu', preventEvents);
            
            // ç¦ç”¨é¸å–ã€è¤‡è£½ã€å‰ªä¸‹ã€è²¼ä¸Šã€æ‹–æ›³
            const events = ['selectstart', 'copy', 'cut', 'paste', 'dragstart'];
            events.forEach(event => document.addEventListener(event, preventEvents));

            // ç¦ç”¨éµç›¤å¿«æ·éµ
            document.addEventListener('keydown', function(e) {
                // Ctrl+A, Ctrl+C, Ctrl+V, Ctrl+U (View Source), Ctrl+S (Save)
                if (e.ctrlKey && ['a', 'c', 'v', 'u', 's'].includes(e.key.toLowerCase())) {
                    preventEvents(e);
                }
                // F12 (é–‹ç™¼è€…å·¥å…·)
                if (e.key === 'F12' || e.keyCode === 123) {
                    preventEvents(e);
                }
            });
        })();

        // --- æ—¥æœŸå·¥å…·å‡½æ•¸ ---
        const formatDate = (date) => {
            return `${date.getFullYear()}å¹´${date.getMonth() + 1}æœˆ${date.getDate()}æ—¥`;
        };

        // å°‡æ™‚é–“æ­¸é›¶ï¼Œåªæ¯”è¼ƒæ—¥æœŸï¼ˆé¿å…æ™‚å€æˆ–ç•¶å‰æ™‚é–“å°è‡´çš„å¤©æ•¸è¨ˆç®—èª¤å·®ï¼‰
        const resetTime = (date) => {
            const d = new Date(date);
            d.setHours(0, 0, 0, 0);
            return d;
        };

        // --- æ ¸å¿ƒåŠŸèƒ½ ---

        function updateDates() {
            const today = new Date();
            
            // é¡¯ç¤ºä»Šå¤©
            document.getElementById('todayDate').textContent = `ä»Šå¤©: ${formatDate(today)}`;
            
            // è¨ˆç®—16å¹´å‰
            const date16YearsAgo = new Date(today);
            date16YearsAgo.setFullYear(today.getFullYear() - 16);
            document.getElementById('age16Date').textContent = `16æ­²: ${formatDate(date16YearsAgo)}`;
            
            // è¨ˆç®—18å¹´å‰
            const date18YearsAgo = new Date(today);
            date18YearsAgo.setFullYear(today.getFullYear() - 18);
            document.getElementById('age18Date').textContent = `18æ­²: ${formatDate(date18YearsAgo)}`;
        }

        function calculateAge() {
            const input = document.getElementById('birthDateInput');
            const resultDiv = document.getElementById('ageResult');
            const val = input.value.trim();

            // æ¸…ç©ºèˆŠçµæœ
            resultDiv.innerHTML = '';

            if (!val) {
                resultDiv.textContent = 'è«‹è¼¸å…¥å‡ºç”Ÿæ—¥æœŸ (æ ¼å¼: YYYY-MM-DD)';
                return;
            }

            // é©—è­‰æ—¥æœŸæ ¼å¼
            if (!validateDateInput(val)) {
                resultDiv.textContent = 'è«‹è¼¸å…¥æœ‰æ•ˆçš„æ—¥æœŸæ ¼å¼ (YYYY-MM-DD)';
                return;
            }

            const birthDate = new Date(val);
            const today = new Date();
            
            // é©—è­‰å¹´ä»½ç¯„åœ
            const year = birthDate.getFullYear();
            if (year < 1900 || year > 2100) {
                resultDiv.textContent = 'è«‹è¼¸å…¥æœ‰æ•ˆçš„å¹´ä»½ (1900-2100)';
                return;
            }

            // æ¯”è¼ƒæ—¥æœŸï¼ˆä¸å«æ™‚é–“ï¼‰
            const todayReset = resetTime(today);
            const birthReset = resetTime(birthDate);

            if (birthReset > todayReset) {
                resultDiv.textContent = 'å‡ºç”Ÿæ—¥æœŸä¸èƒ½åœ¨æœªä¾†';
                return;
            }

            // è¨ˆç®—ç²¾ç¢ºå¹´é½¡
            let years = today.getFullYear() - birthDate.getFullYear();
            let months = today.getMonth() - birthDate.getMonth();
            let days = today.getDate() - birthDate.getDate();

            // å¦‚æœå¤©æ•¸å°æ–¼0ï¼Œå€Ÿä¸Šå€‹æœˆçš„å¤©æ•¸
            if (days < 0) {
                months--;
                // ç²å–ä¸Šå€‹æœˆæœ‰å¤šå°‘å¤© (ä¾‹å¦‚ç¾åœ¨3æœˆï¼Œé€™è£¡æœƒå–å¾—2æœˆçš„ç¸½å¤©æ•¸)
                const prevMonthDate = new Date(today.getFullYear(), today.getMonth(), 0);
                days += prevMonthDate.getDate();
            }

            // å¦‚æœæœˆä»½å°æ–¼0ï¼Œå€Ÿå»å¹´
            if (months < 0) {
                years--;
                months += 12;
            }

            // è¨ˆç®—è·é›¢ä¸‹ä¸€å€‹ç”Ÿæ—¥
            // è¨­å®šä»Šå¹´çš„ç”Ÿæ—¥
            let nextBirthday = new Date(today.getFullYear(), birthDate.getMonth(), birthDate.getDate());
            const nextBirthdayReset = resetTime(nextBirthday);

            // å¦‚æœä»Šå¹´çš„ç”Ÿæ—¥å·²ç¶“éäº†ï¼Œä¸‹ä¸€å€‹ç”Ÿæ—¥å°±æ˜¯æ˜å¹´
            if (nextBirthdayReset < todayReset) {
                nextBirthday.setFullYear(today.getFullYear() + 1);
            }
            
            // é‡æ–°æ­¸é›¶ä»¥ç¢ºä¿è¨ˆç®—æº–ç¢º
            const finalNextBirthday = resetTime(nextBirthday);
            const diffTime = finalNextBirthday - todayReset;
            const daysToNextBirthday = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            // æ§‹å»ºçµæœ HTML
            let resultHTML = `ç›®å‰å¹´é½¡: ${years}æ­² ${months}å€‹æœˆ ${days}å¤©<br>`;
            resultHTML += `<span style="font-size: 0.9em; color: #aaa;">é‚„å·® ${daysToNextBirthday} å¤©æ»¿ ${years + 1} æ­²</span>`;

            // è­¦å‘Šåˆ¤æ–·
            let warningClass = '';
            let warningText = '';

            if (years < 16) {
                warningClass = 'warning warning-red';
                warningText = 'âš ï¸ æœªæ»¿ 16 æ­²';
            } else if (years < 18) {
                warningClass = 'warning warning-orange';
                warningText = 'âš ï¸ æœªæ»¿ 18 æ­²';
            }

            resultDiv.innerHTML = resultHTML;

            if (warningText) {
                const warningDiv = document.createElement('div');
                warningDiv.className = warningClass;
                warningDiv.textContent = warningText;
                resultDiv.appendChild(warningDiv);
            }
        }

        // --- æ—¥æœŸè¼¸å…¥æ ¼å¼åŒ– ---
        let birthDateInput, clearBtn;
        
        // ç­‰å¾…DOMåŠ è¼‰å®Œæˆ
        function initInputElements() {
            birthDateInput = document.getElementById('birthDateInput');
            clearBtn = document.getElementById('clearBtn');
            
            if (!birthDateInput || !clearBtn) {
                console.error('ç„¡æ³•æ‰¾åˆ°è¼¸å…¥æ¡†æˆ–æ¸…é™¤æŒ‰éˆ•');
                return;
            }
            
            // æ›´æ–°æ¸…é™¤æŒ‰éˆ•é¡¯ç¤ºç‹€æ…‹
            function updateClearButton() {
                if (!clearBtn || !birthDateInput) return;
                const hasValue = birthDateInput.value.trim().length > 0;
                if (hasValue) {
                    clearBtn.classList.remove('hidden');
                    clearBtn.style.display = 'block';
                    clearBtn.style.visibility = 'visible';
                } else {
                    clearBtn.classList.add('hidden');
                    clearBtn.style.display = 'none';
                    clearBtn.style.visibility = 'hidden';
                }
            }
            
            // æ¸…é™¤è¼¸å…¥å…§å®¹
            window.clearInput = function(e) {
                if (e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
                if (birthDateInput) {
                    birthDateInput.value = '';
                    birthDateInput.focus();
                }
                updateClearButton();
                // åŒæ™‚æ¸…ç©ºçµæœ
                const resultDiv = document.getElementById('ageResult');
                if (resultDiv) {
                    resultDiv.innerHTML = '';
                }
            };
            
            // ç‚ºæ¸…é™¤æŒ‰éˆ•æ·»åŠ è§¸æ‘¸äº‹ä»¶æ”¯æŒ
            clearBtn.addEventListener('touchstart', function(e) {
                e.preventDefault();
                e.stopPropagation();
                window.clearInput(e);
            }, { passive: false });
            
            clearBtn.addEventListener('touchend', function(e) {
                e.preventDefault();
                e.stopPropagation();
            }, { passive: false });
            
            clearBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                window.clearInput(e);
            });
            
            // è‡ªå‹•æ ¼å¼åŒ–æ—¥æœŸè¼¸å…¥ (YYYY-MM-DD)
            birthDateInput.addEventListener('input', (e) => {
                let value = e.target.value.replace(/[^\d]/g, ''); // åªä¿ç•™æ•¸å­—
                
                // é™åˆ¶é•·åº¦ç‚º8ä½æ•¸å­— (YYYYMMDD)
                if (value.length > 8) {
                    value = value.slice(0, 8);
                }
                
                // è‡ªå‹•æ·»åŠ é€£å­—ç¬¦
                let formatted = '';
                if (value.length > 0) {
                    formatted = value.slice(0, 4); // å¹´ä»½
                    if (value.length > 4) {
                        formatted += '-' + value.slice(4, 6); // æœˆä»½
                    }
                    if (value.length > 6) {
                        formatted += '-' + value.slice(6, 8); // æ—¥æœŸ
                    }
                }
                
                e.target.value = formatted;
                updateClearButton(); // æ›´æ–°æ¸…é™¤æŒ‰éˆ•ç‹€æ…‹
            });
            
            // æŒ‰ä¸‹ Enter éµè§¸ç™¼è¨ˆç®—
            birthDateInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.target.blur(); // é—œé–‰éµç›¤
                    calculateAge();
                }
            });
            
            // åˆå§‹åŒ–æ¸…é™¤æŒ‰éˆ•ç‹€æ…‹
            updateClearButton();
        }
        
        // DOMåŠ è¼‰å®Œæˆå¾Œåˆå§‹åŒ–
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initInputElements);
        } else {
            initInputElements();
        }
        

        // é©—è­‰æ—¥æœŸæ ¼å¼
        function validateDateInput(value) {
            const datePattern = /^(\d{4})-(\d{2})-(\d{2})$/;
            const match = value.match(datePattern);
            
            if (!match) {
                return false;
            }
            
            const year = parseInt(match[1], 10);
            const month = parseInt(match[2], 10);
            const day = parseInt(match[3], 10);
            
            // åŸºæœ¬ç¯„åœæª¢æŸ¥
            if (year < 1900 || year > 2100) return false;
            if (month < 1 || month > 12) return false;
            if (day < 1 || day > 31) return false;
            
            // ä½¿ç”¨ Date å°è±¡é©—è­‰æ—¥æœŸæ˜¯å¦æœ‰æ•ˆ
            const date = new Date(year, month - 1, day);
            if (date.getFullYear() !== year || 
                date.getMonth() !== month - 1 || 
                date.getDate() !== day) {
                return false;
            }
            
            return true;
        }

        // --- äº‹ä»¶ç›£è½ ---
        
        // é»æ“Šç•«é¢å…¶ä»–åœ°æ–¹é—œé–‰éµç›¤
        document.addEventListener('click', (e) => {
            if (birthDateInput && 
                e.target !== birthDateInput && 
                e.target !== clearBtn && 
                e.target.tagName !== 'BUTTON') {
                birthDateInput.blur();
            }
        });

        // åˆå§‹åŒ–
        updateDates();
        // æ¯å¤©è‡ªå‹•åˆ·æ–°ä¸€æ¬¡æ—¥æœŸ
        setInterval(updateDates, 86400000);
    </script>
</body>
</html>